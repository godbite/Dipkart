# Flipkart Clone - System Design & Implementation Plan

A comprehensive system design for building a Flipkart-like e-commerce platform with Express.js backend, React.js frontend, and MongoDB database.

---

## System Architecture Overview

```mermaid
graph TB
    subgraph Frontend["Frontend (React.js)"]
        UI[React Components]
        Router[React Router]
        State[State Management]
    end
    
    subgraph Backend["Backend (Express.js)"]
        API[REST API]
        MW[Middleware]
        Controllers[Controllers]
        Services[Business Logic]
    end
    
    subgraph Database["Database (MongoDB)"]
        Users[(Users)]
        Products[(Products)]
        Categories[(Categories)]
        Cart[(Cart)]
        Orders[(Orders)]
    end
    
    UI --> Router
    Router --> State
    State --> API
    API --> MW
    MW --> Controllers
    Controllers --> Services
    Services --> Users
    Services --> Products
    Services --> Categories
    Services --> Cart
    Services --> Orders
```

---

## Database Schema Design

### 1. User Model
> [!NOTE]
> No authentication required per assignment. We'll have a default user, but the schema supports future auth.

```javascript
// models/User.js
const userSchema = {
  _id: ObjectId,
  name: String,           // "Default User"
  email: String,          // "user@flipkart.com"
  phone: String,
  addresses: [{
    _id: ObjectId,
    fullName: String,
    phone: String,
    addressLine1: String,
    addressLine2: String,
    city: String,
    state: String,
    pincode: String,
    isDefault: Boolean
  }],
  createdAt: Date,
  updatedAt: Date
}
```

---

### 2. Category Model

```javascript
// models/Category.js
const categorySchema = {
  _id: ObjectId,
  name: String,           // "Electronics", "Fashion", etc.
  slug: String,           // "electronics", "fashion"
  image: String,          // Category icon/image URL
  description: String,
  parentCategory: ObjectId,  // For subcategories (null for parent)
  isActive: Boolean,
  createdAt: Date,
  updatedAt: Date
}
```

---

### 3. Product Model

```javascript
// models/Product.js
const productSchema = {
  _id: ObjectId,
  name: String,              // "iPhone 15 Pro"
  slug: String,              // "iphone-15-pro"
  description: String,       // Full product description
  category: ObjectId,        // Reference to Category
  brand: String,             // "Apple"
  
  // Pricing
  price: Number,             // Original price
  sellingPrice: Number,      // Discounted price
  discount: Number,          // Discount percentage
  
  // Images
  images: [String],          // Array of image URLs
  thumbnail: String,         // Main thumbnail image
  
  // Stock & Availability
  stock: Number,             // Available quantity
  isAvailable: Boolean,
  
  // Specifications (key-value pairs for product details)
  specifications: [{
    key: String,             // "RAM", "Storage", "Color"
    value: String            // "8GB", "256GB", "Space Black"
  }],
  
  // Highlights (bullet points)
  highlights: [String],
  
  // Ratings & Reviews
  rating: {
    average: Number,         // 4.5
    count: Number            // Number of ratings
  },
  
  // Search & Filter
  tags: [String],            // For search functionality
  
  createdAt: Date,
  updatedAt: Date
}
```

---

### 4. Cart Model

```javascript
// models/Cart.js
const cartSchema = {
  _id: ObjectId,
  user: ObjectId,            // Reference to User (default user)
  items: [{
    product: ObjectId,       // Reference to Product
    quantity: Number,        // Item quantity
    addedAt: Date
  }],
  createdAt: Date,
  updatedAt: Date
}
```

---

### 5. Order Model

```javascript
// models/Order.js
const orderSchema = {
  _id: ObjectId,
  orderId: String,           // Readable order ID: "OD123456789"
  user: ObjectId,            // Reference to User
  
  // Order Items
  items: [{
    product: ObjectId,       // Reference to Product
    name: String,            // Product name at time of order
    thumbnail: String,       // Product image
    price: Number,           // Price at time of order
    quantity: Number
  }],
  
  // Shipping Address
  shippingAddress: {
    fullName: String,
    phone: String,
    addressLine1: String,
    addressLine2: String,
    city: String,
    state: String,
    pincode: String
  },
  
  // Payment & Pricing
  paymentMethod: String,     // "COD", "Online" (simulated)
  subtotal: Number,
  shippingCharges: Number,
  discount: Number,
  totalAmount: Number,
  
  // Order Status
  status: String,            // "pending", "confirmed", "shipped", "delivered"
  
  // Timestamps
  orderedAt: Date,
  deliveryDate: Date,        // Expected delivery
  createdAt: Date,
  updatedAt: Date
}
```

---

## API Endpoints Design

### Base URL: `/api/v1`

---

### Product APIs

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | `/products` | Get all products with pagination, search & filter |
| `GET` | `/products/:id` | Get single product details |
| `GET` | `/products/slug/:slug` | Get product by slug |
| `GET` | `/products/category/:categoryId` | Get products by category |

#### Query Parameters for `/products`
```
?page=1&limit=12           // Pagination
?search=iphone             // Search by name
?category=electronics      // Filter by category slug
?minPrice=10000&maxPrice=50000   // Price range
?sort=price_asc            // Sorting: price_asc, price_desc, rating, newest
```

#### Response Format
```json
{
  "success": true,
  "data": {
    "products": [...],
    "pagination": {
      "currentPage": 1,
      "totalPages": 5,
      "totalProducts": 60,
      "hasNext": true,
      "hasPrev": false
    }
  }
}
```

---

### Category APIs

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | `/categories` | Get all categories |
| `GET` | `/categories/:id` | Get category by ID |

---

### Cart APIs

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | `/cart` | Get current user's cart |
| `POST` | `/cart/add` | Add item to cart |
| `PUT` | `/cart/update` | Update item quantity |
| `DELETE` | `/cart/remove/:productId` | Remove item from cart |
| `DELETE` | `/cart/clear` | Clear entire cart |

#### Request Body for Add to Cart
```json
{
  "productId": "product_id_here",
  "quantity": 1
}
```

#### Cart Response Format
```json
{
  "success": true,
  "data": {
    "items": [
      {
        "product": { /* populated product details */ },
        "quantity": 2,
        "addedAt": "2024-01-07T10:00:00Z"
      }
    ],
    "summary": {
      "totalItems": 3,
      "subtotal": 45000,
      "discount": 5000,
      "shippingCharges": 0,
      "total": 40000
    }
  }
}
```

---

### Order APIs

| Method | Endpoint | Description |
|--------|----------|-------------|
| `POST` | `/orders` | Place a new order |
| `GET` | `/orders` | Get all orders (order history - bonus) |
| `GET` | `/orders/:orderId` | Get order details by ID |

#### Request Body for Place Order
```json
{
  "shippingAddress": {
    "fullName": "John Doe",
    "phone": "9876543210",
    "addressLine1": "123 Main Street",
    "addressLine2": "Apartment 4B",
    "city": "Mumbai",
    "state": "Maharashtra",
    "pincode": "400001"
  },
  "paymentMethod": "COD"
}
```

#### Order Response Format
```json
{
  "success": true,
  "message": "Order placed successfully",
  "data": {
    "orderId": "OD202401070001",
    "totalAmount": 40000,
    "estimatedDelivery": "2024-01-12",
    "status": "confirmed"
  }
}
```

---

### User APIs (for default user)

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | `/user` | Get default user details |
| `PUT` | `/user/address` | Add/Update address |

---

## Project Structure

### Backend Structure
```
backend/
├── src/
│   ├── config/
│   │   └── db.js              # MongoDB connection
│   ├── models/
│   │   ├── User.js
│   │   ├── Product.js
│   │   ├── Category.js
│   │   ├── Cart.js
│   │   └── Order.js
│   ├── controllers/
│   │   ├── productController.js
│   │   ├── categoryController.js
│   │   ├── cartController.js
│   │   ├── orderController.js
│   │   └── userController.js
│   ├── routes/
│   │   ├── productRoutes.js
│   │   ├── categoryRoutes.js
│   │   ├── cartRoutes.js
│   │   ├── orderRoutes.js
│   │   └── userRoutes.js
│   ├── middleware/
│   │   ├── errorHandler.js
│   │   └── defaultUser.js     # Middleware to set default user
│   ├── utils/
│   │   └── helpers.js
│   ├── seeds/
│   │   └── seedData.js        # Sample data seeding
│   └── app.js                 # Express app setup
├── .env
├── .gitignore
├── package.json
└── server.js
```

### Frontend Structure
```
frontend/
├── public/
│   └── index.html
├── src/
│   ├── components/
│   │   ├── common/
│   │   │   ├── Header.jsx
│   │   │   ├── Footer.jsx
│   │   │   ├── Navbar.jsx
│   │   │   └── ProductCard.jsx
│   │   ├── product/
│   │   │   ├── ProductGrid.jsx
│   │   │   ├── ProductFilter.jsx
│   │   │   ├── ImageCarousel.jsx
│   │   │   └── ProductSpecs.jsx
│   │   ├── cart/
│   │   │   ├── CartItem.jsx
│   │   │   └── CartSummary.jsx
│   │   └── checkout/
│   │       ├── AddressForm.jsx
│   │       └── OrderSummary.jsx
│   ├── pages/
│   │   ├── HomePage.jsx
│   │   ├── ProductListPage.jsx
│   │   ├── ProductDetailPage.jsx
│   │   ├── CartPage.jsx
│   │   ├── CheckoutPage.jsx
│   │   └── OrderConfirmationPage.jsx
│   ├── services/
│   │   └── api.js             # API client (axios)
│   ├── context/
│   │   └── CartContext.jsx    # Cart state management
│   ├── hooks/
│   │   └── useCart.js
│   ├── styles/
│   │   └── index.css          # Global styles
│   ├── App.jsx
│   └── main.jsx
├── .env
├── .gitignore
├── package.json
└── vite.config.js
```

---

## Entity Relationship Diagram

```mermaid
erDiagram
    USER ||--o{ ORDER : places
    USER ||--|| CART : has
    CART ||--|{ CART_ITEM : contains
    CART_ITEM }|--|| PRODUCT : references
    ORDER ||--|{ ORDER_ITEM : contains
    ORDER_ITEM }|--|| PRODUCT : references
    PRODUCT }|--|| CATEGORY : belongs_to
    CATEGORY ||--o{ CATEGORY : has_subcategory
    
    USER {
        ObjectId _id
        String name
        String email
        String phone
        Array addresses
    }
    
    CATEGORY {
        ObjectId _id
        String name
        String slug
        String image
        ObjectId parentCategory
    }
    
    PRODUCT {
        ObjectId _id
        String name
        String slug
        Number price
        Number sellingPrice
        Array images
        Number stock
        Boolean isAvailable
        ObjectId category
    }
    
    CART {
        ObjectId _id
        ObjectId user
        Array items
    }
    
    ORDER {
        ObjectId _id
        String orderId
        ObjectId user
        Array items
        Object shippingAddress
        Number totalAmount
        String status
    }
```

---

## Sample Categories & Products to Seed

### Categories
1. **Electronics** - Mobiles, Laptops, Tablets, Audio
2. **Fashion** - Men's Clothing, Women's Clothing, Footwear
3. **Home & Furniture** - Furniture, Decor, Kitchen
4. **Appliances** - TVs, Washing Machines, Refrigerators
5. **Grocery** - Staples, Beverages, Snacks

### Sample Products per Category
- Each category will have **8-10 sample products**
- Products will have realistic prices, images, and specifications
- Total: **40-50 sample products**

---

## Verification Plan

### 1. Backend API Testing
```bash
# Start backend server
cd backend && npm run dev

# Test endpoints using REST client or browser
# - GET http://localhost:5000/api/v1/products
# - GET http://localhost:5000/api/v1/categories
# - GET http://localhost:5000/api/v1/cart
# - POST http://localhost:5000/api/v1/cart/add
# - POST http://localhost:5000/api/v1/orders
```

### 2. Frontend Testing
```bash
# Start frontend
cd frontend && npm run dev

# Manual browser testing:
# - View product listing page
# - Search for products
# - Filter by category
# - View product details
# - Add to cart
# - Update cart quantities
# - Complete checkout flow
```

### 3. Integration Testing
- Verify API responses match expected format
- Test error handling scenarios
- Verify cart persistence
- Complete end-to-end order placement

---

## User Review Required

> [!IMPORTANT]
> **Database Choice**: Assignment mentions PostgreSQL or MySQL, but you've chosen MongoDB. This is acceptable per your preference. Please confirm MongoDB is your final choice.

> [!NOTE]
> **Authentication**: Per assignment, no login is required. The system will use a default user. However, the schema supports adding authentication later as a bonus feature.

**Please confirm:**
1. Is the database schema design appropriate for your needs?
2. Do the API endpoints cover all required functionality?
3. Should I include any additional features from the "Good to Have" list in the initial implementation?
   - Order history (view past orders)
   - Wishlist functionality
   - Email notification on order

---

## Next Steps After Approval

1. Initialize Express.js backend with MongoDB connection
2. Create all database models
3. Implement API routes and controllers
4. Add seed data for categories and products
5. Initialize React.js frontend with Vite
6. Build UI components matching Flipkart's design
7. Integrate frontend with backend APIs
8. Test and deploy
